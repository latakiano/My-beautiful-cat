<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Cat - Master Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial', sans-serif; touch-action: none; }
        #ui { position: absolute; top: 10px; width: 100%; text-align: center; color: white; z-index: 10; pointer-events: none; }
        .bar { width: 80%; height: 12px; background: #222; margin: 5px auto; border-radius: 6px; border: 1px solid #444; overflow: hidden; }
        #fill { width: 0%; height: 100%; background: linear-gradient(90deg, #0f0, #ff0, #f00); box-shadow: 0 0 10px #0f0; }
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; z-index: 1000; text-align: center; }
        button { padding: 15px 45px; font-size: 24px; cursor: pointer; border-radius: 30px; background: #ff00cc; color: white; border: none; font-weight: bold; box-shadow: 0 0 20px #ff00cc; }
    </style>
</head>
<body>

<div id="ui">
    <div id="lvlName" style="font-size: 22px; font-weight: bold; color: #0ff;">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1</div>
    <div class="bar"><div id="fill"></div></div>
    <div style="font-size: 16px;">ğŸŸ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²: <span id="score">0</span> | ğŸ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span id="dist">1000</span>m</div>
</div>

<div id="overlay">
    <h1 id="msg">Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ù€ 20 Ù…Ø±Ø­Ù„Ø© ğŸ¾</h1>
    <button onclick="setupStage()">Ø§Ù†Ø·Ù„Ø§Ù‚ ğŸš€</button>
</div>

<canvas id="c"></canvas>

<script>
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const overlay = document.getElementById('overlay');

    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    // 20 Ù…Ø±Ø­Ù„Ø© Ø¨ØªØ¯Ø±Ø¬Ø§Øª Ø£Ù„ÙˆØ§Ù† ÙØ®Ù…Ø©
    const stages = [
        {n:"ØºØ§Ø¨Ø© Ø§Ù„Ø°Ø¦Ø§Ø¨", bg:"#0a0a0a", col:"#f1c40f", s:6},
        {n:"Ù…Ù‚Ø¨Ø±Ø© Ø§Ù„Ø£Ø´Ø¨Ø§Ø­", bg:"#1a002a", col:"#9b59b6", s:7},
        {n:"Ø¬Ø¨Ø§Ù„ Ø§Ù„Ù†Ø³ÙˆØ±", bg:"#001f3f", col:"#3498db", s:8},
        {n:"ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø£ÙØ§Ø¹ÙŠ", bg:"#1a0d00", col:"#e67e22", s:9},
        {n:"Ù†Ù‡Ø± Ø§Ù„ØªÙ…Ø§Ø³ÙŠØ­", bg:"#002b2b", col:"#1abc9c", s:10},
        {n:"Ø¹Ø±ÙŠÙ† Ø§Ù„Ø£Ø³Ø¯", bg:"#2d1400", col:"#e74c3c", s:11},
        {n:"ÙƒÙ‡Ù Ø§Ù„ØªÙ†ÙŠÙ†", bg:"#200000", col:"#ff0000", s:12},
        {n:"Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¬Ù„ÙŠØ¯", bg:"#001a1a", col:"#00d4ff", s:13},
        {n:"ÙƒÙˆÙƒØ¨ Ø§Ù„ÙØ¶Ø§Ø¦ÙŠÙŠÙ†", bg:"#0a0015", col:"#00ffcc", s:14},
        {n:"Ø¨Ø­Ø± Ø§Ù„Ù‚Ø±ÙˆØ´", bg:"#000a20", col:"#2980b9", s:15},
        {n:"Ù…ØµÙ†Ø¹ Ø§Ù„Ø¢Ù„ÙŠÙŠÙ†", bg:"#111", col:"#95a5a6", s:16},
        {n:"ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù†Ù…ÙˆØ±", bg:"#2c1e00", col:"#f39c12", s:17},
        {n:"Ø§Ù„ØºØ§Ø¨Ø© Ø§Ù„Ù…Ø¸Ù„Ù…Ø©", bg:"#000", col:"#fff", s:18},
        {n:"Ù‚Ù…Ø© Ø§Ù„Ù†Ø§Ø±", bg:"#300", col:"#ff4500", s:19},
        {n:"Ø¹Ø§Ù„Ù… Ø§Ù„Ø³Ø­Ø±", bg:"#1a001a", col:"#ff00ff", s:20},
        {n:"Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©", bg:"#2a1a00", col:"#ffd700", s:21},
        {n:"Ø£Ø¹Ù…Ø§Ù‚ Ø§Ù„Ù…Ø­ÙŠØ·", bg:"#001", col:"#00ffff", s:22},
        {n:"Ø§Ù„Ù…Ø®ØªØ¨Ø± Ø§Ù„Ø³Ø±ÙŠ", bg:"#010", col:"#0f0", s:23},
        {n:"Ø­Ø§ÙØ© Ø§Ù„ÙƒÙˆÙ†", bg:"#000", col:"#cc00ff", s:24},
        {n:"Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø±Ø­Ù„Ø©", bg:"#000", col:"#ff00cc", s:26}
    ];

    let cur = 0, score = 0, dist = 1000, active = false, started = false;
    let p = { x: 80, y: 300, v: 0 }, m = { x: -150, y: 300 }, obs = [], items = [];

    // Ø±Ø³Ù… Ø§Ù„Ù‚Ø·Ø© Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ (Ø³ÙŠØ§Ù…ÙŠ)
    function drawCat(x, y) {
        ctx.save();
        ctx.fillStyle = "#fff"; // Ø§Ù„Ø¬Ø³Ù…
        ctx.beginPath(); ctx.ellipse(x+25, y+20, 25, 18, 0, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = "#5d4037"; // Ø§Ù„ÙˆØ¬Ù‡ Ø§Ù„Ø³ÙŠØ§Ù…ÙŠ
        ctx.beginPath(); ctx.arc(x+40, y+10, 12, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = "#00d4ff"; // Ø¹ÙŠÙˆÙ† Ø²Ø±Ù‚Ø§Ø¡ Ù…ØªÙˆÙ‡Ø¬Ø©
        ctx.beginPath(); ctx.arc(x+44, y+8, 3, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = "#5d4037"; // Ø§Ù„Ø£Ø°Ù†ÙŠÙ†
        ctx.beginPath(); ctx.moveTo(x+32, y); ctx.lineTo(x+35, y-12); ctx.lineTo(x+40, y); ctx.fill();
        ctx.restore();
    }

    // Ø±Ø³Ù… Ø§Ù„ÙˆØ­Ø´ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ (Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø­Ù„Ø©)
    function drawMonster(x, y, color) {
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.moveTo(x, y+25); ctx.lineTo(x+40, y-20); ctx.lineTo(x+80, y+25); ctx.lineTo(x+40, y+70);
        ctx.fill();
        ctx.fillStyle = "white"; ctx.beginPath(); ctx.arc(x+40, y+25, 15, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = "black"; ctx.beginPath(); ctx.arc(x+40, y+25, 7, 0, Math.PI*2); ctx.fill();
    }

    window.setupStage = function() {
        overlay.style.display = 'none';
        dist = 1000; p.y = canvas.height/2; p.v = 0; m.x = -150;
        obs = []; items = [];
        document.getElementById('lvlName').innerText = `ğŸŒˆ ${stages[cur].n} ğŸŒˆ`;
        active = true; started = false;
    };

    function loop() {
        const s = stages[cur];
        ctx.fillStyle = s.bg; ctx.fillRect(0, 0, canvas.width, canvas.height);

        if (active && started) {
            p.v += 0.45; p.y += p.v; dist -= s.s / 10;
            m.y += (p.y - m.y) * 0.06; m.x = Math.min(p.x - 110, m.x + 0.4);

            if (dist <= 0) {
                active = false; cur++;
                if(cur >= stages.length) { msg.innerHTML = "ğŸ† Ø®ØªÙ…ØªÙ Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ†"; cur=0; }
                else { msg.innerHTML = "Ø£Ø¨Ø¯Ø¹ØªÙ! Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø±Ø­Ù„Ø© " + (cur+1); }
                overlay.style.display = 'flex';
            }

            if (dist > 50 && (obs.length === 0 || obs[obs.length-1].x < canvas.width - 350)) {
                let gapY = Math.random() * (canvas.height - 350) + 100;
                obs.push({ x: canvas.width, y: gapY, g: 280 });
                items.push({ x: canvas.width + 50, y: gapY + 140 });
            }

            obs.forEach((o, i) => {
                o.x -= s.s;
                if(p.x+45 > o.x && p.x < o.x+50 && (p.y < o.y || p.y+35 > o.y+o.g)) { active=false; overlay.style.display='flex'; }
                if(o.x < -100) obs.splice(i, 1);
            });

            items.forEach((f, i) => {
                f.x -= s.s;
                if(Math.hypot(p.x-f.x, p.y-f.y) < 50) { score += 100; items.splice(i, 1); }
            });

            if(p.y > canvas.height || p.y < -50 || p.x < m.x + 40) { active=false; overlay.style.display='flex'; }
            document.getElementById('fill').style.width = (1 - (dist/1000))*100 + "%";
            document.getElementById('dist').innerText = Math.max(0, Math.floor(dist));
            document.getElementById('score').innerText = score;
        }

        drawMonster(m.x, m.y, s.col);
        obs.forEach(o => { 
            ctx.fillStyle = s.col; ctx.shadowBlur = 15; ctx.shadowColor = s.col;
            ctx.fillRect(o.x, 0, 45, o.y); ctx.fillRect(o.x, o.y+o.g, 45, canvas.height);
            ctx.shadowBlur = 0;
        });
        items.forEach(f => {
            ctx.fillStyle = "#ff0"; ctx.beginPath(); ctx.arc(f.x, f.y, 12, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = "#fff"; ctx.fillText("ğŸŸ", f.x-8, f.y+5);
        });
        drawCat(p.x, p.y);

        requestAnimationFrame(loop);
    }

    const tap = () => { if(active) started = true; p.v = -8.5; };
    window.addEventListener('mousedown', tap);
    window.addEventListener('touchstart', (e) => { e.preventDefault(); tap(); }, {passive: false});
    loop();
</script>
</body>
</html>